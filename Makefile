# Compiler settings
CC=gcc
CFLAGS=-Wall -Wextra

# Default target: compile the main executable
all: copybench

# Help target to display available commands
help:
	@echo "Available targets:"
	@echo "  bigfile     generates a 10MB file of random data from /dev/urandom"
	@echo "  copybench   compiles the copybench executable"
	@echo "  run         executes the benchmark"
	@echo "  clean       deletes all generated files (including bigfile)"

# Compile the main program
copybench: copy_functions.o copybench.o
	$(CC) $(CFLAGS) -o $@ $^

# Compile object files from source files
%.o: %.c
	$(CC) $(CFLAGS) -c $<

# Generate a test file with random data
bigfile:
	dd if=/dev/urandom of=bigfile bs=1M count=10

# Run the benchmark test
run: copybench bigfile
	./copybench bigfile output_file

# Clean up all generated files
clean:
	rm -f copybench *.o bigfile output_file test_program testfile

.PHONY: all help clean run bigfile
